'use strict';class koke_class{constructor(a,b){this.ss=SpreadsheetApp.getActiveSpreadsheet();this.sheet=this.ss.getActiveSheet();this.url=a;this.label=b;this.data=UrlFetchApp.fetch(this.url).getContentText();this.data=JSON.parse(this.data);this.data=this.data.data.sort()}SelectSheet(a){return this.ss.getSheetByName(a)}InsertSheet(a){this.ss.insertSheet().setName(a)}InsertData(a){InsertSheet(a);this.sheet=SelectSheet(a);this.label.forEach((b,c)=>{console.log(b,c);this.sheet.getRange(1,c+1).setValue(b)});
for(let b of this.data)a=this.sheet.getLastRow(),console.log(b.ImageName),console.log(a),this.sheet.getRange(a+1,1).setValue(b.ImageName),this.sheet.getRange(a+1,2).setValue(b.Lng),this.sheet.getRange(a+1,3).setValue(b.Lat)}}let class_run=a=>{let b=`\u64c1\u58c1${a}`;a=new koke_class(`https://peaceful-temple-64943.herokuapp.com/koke/${a}`,["\u5199\u771f\u540d","\u7def\u5ea6","\u7d4c\u5ea6","\u7a2e\u540d"]);console.log(a.url);a.InsertData(b)},main=()=>{class_run(20)};