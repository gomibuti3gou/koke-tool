'use strict';class koke_class{constructor(a,b){this.ss=SpreadsheetApp.getActiveSpreadsheet();this.sheet=null;this.url=a;this.label=b;this.err=this.code=this.data=null}SetData(){try{let a=UrlFetchApp.fetch(this.url);this.code=a.getResponseCode();if(201==this.code){let b=a.getContentText();b=JSON.parse(b);this.data=b.data.sort()}}catch(a){Logger.log("Error:"),Logger.log(a),this.err=a}finally{return this.code}}SelectSheet(a){return this.ss.getSheetByName(a)}InsertSheet(a){this.ss.insertSheet().setName(a)}InsertData(a){SetData();
InsertSheet(a);this.sheet=SelectSheet(a);this.label.forEach((b,c)=>{console.log(b,c);this.sheet.getRange(1,c+1).setValue(b)});for(let b of this.data)a=this.sheet.getLastRow(),console.log(b.ImageName),console.log(a),this.sheet.getRange(a+1,1).setValue(b.ImageName),this.sheet.getRange(a+1,2).setValue(b.Lng),this.sheet.getRange(a+1,3).setValue(b.Lat)}}
class kokeClass extends koke_class{constructor(a,b,c){super(a,b);this.name=c}InsertData(){super.SetData();if(null==this.err){console.log(this.name);super.SetData();super.InsertSheet(this.name);this.sheet=super.SelectSheet(this.name);this.label.forEach((a,b)=>{this.sheet.getRange(1,b+1).setValue(a)});for(let a of this.data){let b=this.sheet.getLastRow();this.sheet.getRange(b+1,1).setValue(a.ImageName);this.sheet.getRange(b+1,2).setValue(a.Lng);this.sheet.getRange(b+1,3).setValue(a.Lat)}}else console.log(`Error Message ${this.err}`)}}
class Run{static run(a){var b=`https://localhost:3000/koke/${a}`;a=`\u64c1\u58c1${a}`;console.log(a);b=new kokeClass(b,["\u5199\u771f\u540d","\u7def\u5ea6","\u7d4c\u5ea6","\u7a2e\u540d"],a);console.log(b.url);b.InsertData()}}let main=()=>{for(let a=1;20>=a;a++)Run.run(a)};